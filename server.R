
library(shiny)

Heightcms<-c(188,
             185,
             185,
             198,
             198,
             203,
             198,
             185,
             178,
             208,
             198,
             188,
             178,
             188,
             193,
             170,
             196,
             185,
             196,
             185,
             191,
             180,
             188,
             183,
             188,
             183,
             183,
             188,
             183,
             183,
             185,
             178,
             193,
             188,
             191,
             188,
             183,
             188,
             188,
             191,
             188,
             180,
             185,
             185,
             198,
             183,
             175,
             188,
             198,
             193,
             196,
             193,
             191,
             196,
             188,
             183,
             196,
             191,
             183,
             193,
             196,
             180,
             188,
             188,
             183,
             188,
             183,
             188,
             170,
             191,
             191,
             183,
             211,
             193,
             183,
             196,
             183,
             183,
             183,
             193,
             178,
             191,
             185,
             193,
             180,
             191,
             188,
             196,
             185,
             198,
             183,
             188,
             185,
             180,
             188,
             185,
             211,
             175,
             188,
             185)

Weightkg<-c(77,
            85,
            85,
            90,
            97,
            94,
            89,
            79,
            73,
            108,
            87,
            85,
            79,
            83,
            85,
            64,
            98,
            78,
            83,
            79,
            81,
            70,
            78,
            75,
            89,
            79,
            75,
            90,
            69,
            70,
            84,
            79,
            85,
            86,
            78,
            75,
            79,
            82,
            86,
            85,
            88,
            79,
            81,
            74,
            90,
            83,
            68,
            80,
            95,
            86,
            92,
            85,
            80,
            90,
            75,
            72,
            91,
            77,
            81,
            87,
            80,
            79,
            83,
            76,
            79,
            88,
            73,
            82,
            64,
            88,
            84,
            82,
            104,
            88,
            77,
            81,
            78,
            75,
            76,
            90,
            73,
            80,
            84,
            84,
            80,
            85,
            70,
            91,
            85,
            94,
            82,
            82,
            75,
            80,
            72,
            75,
            102,
            69,
            88,
            80)
        
ATPsize<-data.frame(Heightcms, Weightkg)
shinyServer(function(input, output) {
        model1 <- lm(Weightkg ~ Heightcms, data = ATPsize)
        model1pred <- reactive({
                heightInput <- input$sliderHeight
                predict(model1, newdata = data.frame(Heightcms = heightInput))
        })
        
        
        output$plot1 <- renderPlot({
                heightInput <- input$sliderHeight
                
                plot(ATPsize$Heightcms, ATPsize$Weightkg, xlab = "Height in cms", 
                     ylab = "Weight in Kgs", pch = 16,
                     xlim = c(170, 215), ylim = c(60, 110))
                if(input$showModel1){
                        abline(model1, col = "red", lwd = 2)
                }
                
                legend(25, c("Model 1 Prediction"), pch=16,
                       col=c("red"), cex=1.2)
                
                points(heightInput, model1pred(), col = "red", pch = 16, cex = 2)
                
        })
        
        output$pred1 <- renderText({
                model1pred()
        })
        
        
})

